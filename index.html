<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoPilot IDE - AI-Powered Python Development</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="top-bar-left">
                <div class="logo">
                    <div class="logo-icon">AP</div>
                    <span>AutoPilot IDE</span>
                </div>
                
                <div class="menu-tabs">
                    <!-- File Menu -->
                    <div class="menu-tab-wrapper">
                        <button class="menu-tab" onclick="toggleDropdown('fileMenu', event)">File</button>
                        <div id="fileMenu" class="dropdown-menu">
                            <div class="dropdown-item" onclick="window.projectManager?.showProjectModal()">
                                <span class="dropdown-item-icon">üìÅ</span>
                                <span>Open Project...</span>
                            </div>
                            <div class="dropdown-item" onclick="window.projectManager?.createNewProject()">
                                <span class="dropdown-item-icon">‚ú®</span>
                                <span>New Project</span>
                            </div>
                            <div class="dropdown-separator"></div>
                            <div class="dropdown-item" onclick="window.projectManager?.saveCurrentFile()">
                                <span class="dropdown-item-icon">üíæ</span>
                                <span>Save</span>
                            </div>
                            <div class="dropdown-item" onclick="window.projectManager?.saveAllFiles()">
                                <span class="dropdown-item-icon">üíæ</span>
                                <span>Save All</span>
                            </div>
                        </div>
                    </div>

                    <!-- Edit Menu -->
                    <div class="menu-tab-wrapper">
                        <button class="menu-tab" onclick="toggleDropdown('editMenu', event)">Edit</button>
                        <div id="editMenu" class="dropdown-menu">
                            <div class="dropdown-item">
                                <span class="dropdown-item-icon">‚Ü©Ô∏è</span>
                                <span>Undo</span>
                            </div>
                            <div class="dropdown-item">
                                <span class="dropdown-item-icon">‚Ü™Ô∏è</span>
                                <span>Redo</span>
                            </div>
                            <div class="dropdown-separator"></div>
                            <div class="dropdown-item">
                                <span class="dropdown-item-icon">‚úÇÔ∏è</span>
                                <span>Cut</span>
                            </div>
                            <div class="dropdown-item">
                                <span class="dropdown-item-icon">üìã</span>
                                <span>Copy</span>
                            </div>
                            <div class="dropdown-item">
                                <span class="dropdown-item-icon">üìÑ</span>
                                <span>Paste</span>
                            </div>
                        </div>
                    </div>

                    <!-- View Menu -->
                    <div class="menu-tab-wrapper">
                        <button class="menu-tab" onclick="toggleDropdown('viewMenu', event)">View</button>
                        <div id="viewMenu" class="dropdown-menu">
                            <div class="dropdown-item" onclick="window.layoutManager?.toggleSidebar()">
                                <span class="dropdown-item-icon">üìÇ</span>
                                <span>Explorer</span>
                                <span id="explorerCheck" class="dropdown-item-check">‚úì</span>
                            </div>
                            <div class="dropdown-item" onclick="window.layoutManager?.toggleTerminal()">
                                <span class="dropdown-item-icon">üíª</span>
                                <span>Terminal</span>
                                <span id="terminalCheck" class="dropdown-item-check">‚úì</span>
                            </div>
                            <div class="dropdown-item" onclick="window.layoutManager?.toggleAIPanel()">
                                <span class="dropdown-item-icon">ü§ñ</span>
                                <span>AI Assistant</span>
                                <span id="aiPanelCheck" class="dropdown-item-check">‚úì</span>
                            </div>
                        </div>
                    </div>

                    <!-- Extensions Menu -->
                    <div class="menu-tab-wrapper">
                        <button class="menu-tab" onclick="toggleDropdown('extensionsMenu', event)">Extensions</button>
                        <div id="extensionsMenu" class="dropdown-menu">
                            <div class="dropdown-item" onclick="window.extensionManager?.showManageModal()">
                                <span class="dropdown-item-icon">üîß</span>
                                <span>Manage Extensions</span>
                            </div>
                            <div class="dropdown-item" onclick="window.extensionManager?.showGetModal()">
                                <span class="dropdown-item-icon">üì¶</span>
                                <span>Get Extensions</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="integration-buttons">
                <button class="btn btn-github">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                    </svg>
                    <span>GitHub</span>
                </button>
                <button class="btn btn-huggingface">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
                    </svg>
                    <span>HuggingFace</span>
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-header-left">
                        <div class="sidebar-title">Explorer</div>
                        <div id="projectName" class="project-name">No Project</div>
                    </div>
                </div>
                
                <div class="sidebar-actions">
                    <button class="sidebar-btn" onclick="window.projectManager?.createNewFile()">
                        <span>üìÑ</span>
                        <span>New File</span>
                    </button>
                    <button class="sidebar-btn" onclick="window.projectManager?.createNewFolder()">
                        <span>üìÅ</span>
                        <span>New Folder</span>
                    </button>
                    <button class="sidebar-btn" onclick="window.projectManager?.refreshFileTree()">
                        <span>üîÑ</span>
                        <span>Refresh</span>
                    </button>
                </div>
                
                <div id="fileTree" class="file-tree">
                    <!-- File tree will be populated by project-manager.js -->
                </div>
            </div>

            <div class="sidebar-resizer"></div>

            <!-- Editor Area -->
            <div class="editor-area">
                <div class="editor-container">
                    <div class="editor-and-terminal">
                        <!-- Tabs -->
                        <div class="tabs">
                            <div class="tab active">
                                <span class="file-icon">üìÑ</span>
                                <span>Untitled</span>
                            </div>
                        </div>

                        <!-- Editor -->
                        <div id="editor" class="editor">
                            <!-- Editor content will be populated by JavaScript -->
                        </div>

                        <!-- Resizer -->
                        <div class="resizer"></div>

                        <!-- Terminal -->
                        <div id="terminalSection" class="terminal-section">
                            <div class="terminal-header">
                                <div class="terminal-header-left">
                                    <span class="terminal-title">Terminal</span>
                                    <div class="terminal-tabs">
                                        <button class="terminal-tab active">
                                            <span>üíª</span>
                                            <span>bash</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="terminal-actions">
                                    <button id="toggleTerminalBtn" class="terminal-btn" title="Toggle Terminal">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                    </button>
                                    <button class="terminal-btn" title="Clear Terminal" onclick="document.getElementById('terminalContent').innerHTML = document.getElementById('terminalContent').querySelector('.terminal-input-line').outerHTML">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div id="terminalContent" class="terminal-content">
                                <div class="terminal-line">
                                    <span class="terminal-output">AutoPilot IDE Terminal v1.0</span>
                                </div>
                                <div class="terminal-line">
                                    <span class="terminal-output">Initializing...</span>
                                </div>
                                <div class="terminal-input-line">
                                    <span class="terminal-prompt">user@autopilot:~/project$</span>
                                    <input id="terminalInput" type="text" class="terminal-input" autocomplete="off" spellcheck="false">
                                    <span class="terminal-cursor"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="ai-panel-resizer"></div>

            <!-- AI Panel -->
            <div id="aiPanel" class="ai-panel">
                <div class="ai-header">
                    <div class="ai-header-left">
                        <div class="ai-icon">ü§ñ</div>
                        <div class="ai-title">AI Assistant</div>
                    </div>
                    <div class="ai-actions">
                        <button class="icon-btn" title="Clear Chat" onclick="document.getElementById('aiChat').innerHTML = ''">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="ai-mode-selector">
                    <button class="mode-btn active">
                        <span>üí¨ Chat</span>
                    </button>
                    <button class="mode-btn">
                        <span>üìñ Explain</span>
                    </button>
                    <button class="mode-btn">
                        <span>üêõ Debug</span>
                    </button>
                    <button class="mode-btn">
                        <span>üîß Refactor</span>
                    </button>
                </div>

                <div class="ai-context">
                    <div class="context-left">
                        <div class="context-indicator"></div>
                        <span>Connected</span>
                    </div>
                </div>

                <div id="aiChat" class="ai-chat">
                    <div class="ai-message">
                        <p>üëã Hello! I'm your AI assistant. I can help you with:</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Writing and refactoring code</li>
                            <li>Debugging issues</li>
                            <li>Explaining code concepts</li>
                            <li>Answering Python questions</li>
                        </ul>
                        <p style="margin-top: 10px;">How can I help you today?</p>
                    </div>
                </div>

                <div class="ai-input-wrapper">
                    <div class="ai-input-container">
                        <textarea id="aiInput" class="ai-input" placeholder="Ask me anything..." rows="1"></textarea>
                        <button id="sendBtn" class="send-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left">
                <div class="status-item">
                    <span>üîå</span>
                    <span id="connectionStatus">Connecting...</span>
                </div>
                <div class="status-item">
                    <span>üìÅ</span>
                    <span id="statusProject">No Project</span>
                </div>
            </div>
            <div class="status-right">
                <div class="status-item">
                    <span>üêç</span>
                    <span>Python 3.13</span>
                </div>
                <div class="status-item">
                    <span>UTF-8</span>
                </div>
                <div class="status-item">
                    <span>Ln 1, Col 1</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals (kept minimal, managed by respective modules) -->
    <div id="projectModal" class="modal">
        <!-- Project modal content managed by project-manager.js -->
    </div>

    <div id="manageExtensionsModal" class="modal">
        <!-- Extensions modal content managed by extension-manager.js -->
    </div>

    <div id="getExtensionsModal" class="modal">
        <!-- Get extensions modal content managed by extension-manager.js -->
    </div>

    <!-- JavaScript Modules - Load in correct dependency order -->
    
    <!-- Core modules first -->
    <script src="js/socket-client.js"></script>
    <script src="js/project-manager.js"></script>
    <script src="js/layout-manager.js"></script>
    <script src="js/ui-handlers.js"></script>
    
    <!-- Optional modules -->
    <script src="js/extension-manager.js"></script>
    <script src="js/theme-manager.js"></script>
    
    <!-- Initialize last -->
    <script src="js/init.js"></script>
</body>
</html>
